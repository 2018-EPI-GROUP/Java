## 利用反射机制给私有成员赋值

- 用户输入"成员:属性|成员:属性|...."类型的字符串，通过factory工厂设计模式以及反射机制给某个对象的私有成员赋值。

**类定义**

```java
public class Emp {
	private String name;
	private int year;
	private Double days;
	
	public Double getDays() {
		return days;
	}

	public void setDays(Double days) {
		this.days = days;
	}

	public Emp() {
	}

	public String getName() {
		return name;
	}
	public void setName(String name) {
		this.name = name;
	}
	public int getYear() {
		return year;
	}
	public void setYear(int year) {
		this.year = year;
	}
	@Override
	public String toString() {
		return "Emp [name=" + name + ", year=" + year + ", days=" + days + "]";
	}
}
```

**工厂类**

```java
public class Factory {
	public String initcap(String str) {
		if(str == null || "".equals(str)) {
			return str;
		}else if(str.length()==1){
			return str.toUpperCase();
		}else {
			return str.substring(0,1).toUpperCase() + str.substring(1);
		}
	}
	public void setValue(Object obj,String str) throws Exception {
		String results[]=str.split("\\|");
		for(String temp:results) {
			String []ar = temp.split(":");
			try{
				Field filed = obj.getClass().getDeclaredField(ar[0]);
				filed.setAccessible(true);
				Method mes = obj.getClass().getDeclaredMethod("set" + this.initcap(ar[0]), filed.getType());
				String p=ar[1];
				if("int".equals(filed.getType().getSimpleName())) {
					mes.invoke(obj,Integer.parseInt(ar[1]));
				}
				else if("Double".equals(filed.getType().getSimpleName())) {
					mes.invoke(obj,Double.parseDouble(ar[1]));
				}
				else mes.invoke(obj,p);
			}catch (IllegalArgumentException e) {
				e.printStackTrace();
			}
			
		}
	}
	public <T> T getInstance(String value,Class<T> cls) {
		try {
			Object obj = cls.getDeclaredConstructor().newInstance();
			this.setValue(obj, value);
			return (T)obj;
		}catch (Exception e){
			e.printStackTrace();
			return null;
		}	
	}
}
```

**主方法**

```java
public static void main(String[] args) {
		Factory fac = new Factory();
		Emp emp = fac.getInstance("name:介恒|year:35|days:7823",Emp.class);
		System.out.println(emp);
	}

```

