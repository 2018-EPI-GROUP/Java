## 等待唤醒机制

- **问题描述**

设计一个生产计算机和搬运计算机类，要求生产出一台计算机就搬走一台计算机，如果没有新的计算机生产出来，则搬运工要等待新计算机产出；如果生产的计算机没有搬走，则要等待计算机搬走后再生产，并统计计算机生产的计算机数量。

- **代码核心要点**

   1.两个类必须使用同一个计算机类对象；

2. 在synchronized(锁对象)中锁对象必须是唯一的，即两个类中的同步锁对象为一个；
3. 通过同步类中的boolean值来判断compute的状态，并利用此状态进行通信。

- **代码实现**
  * 制造计算机类

```Java
package impl;

public class Creat implements Runnable{
	compute com = new compute();
	static boolean stop = true;
	public Creat(compute cm) {
		this.com=cm;
	}
	@Override
	public void run() {
		while(stop==true) {
			synchronized (this.com) {
				if(com.status==true) {
					try {
						com.wait();
					} catch (InterruptedException e) {
						e.printStackTrace();
					}
				}
					System.out.println("正在制造电脑！");
					try {
						Thread.sleep(200);
					} catch (InterruptedException e) {
						e.printStackTrace();
					}
				    System.out.println("制造完毕！");
				    compute.num++;
				    System.out.println("现在电脑有：" + compute.num + "台");
                	/*判断现在的电脑数是否满足所需的电脑数*/
				    if(compute.num==5) {	
				    	stop=false;		//如果满足，利用标志停止线程
				    }
				    com.status=true;
				    this.com.notifyAll();
				   
			}
		}	
	}	
}
```

* 搬运计算机类

```java
package impl;

public class move implements Runnable{
	compute com = new compute();
	static boolean stop = true;
	public move(compute com) {
		this.com=com;
	}
	@Override
	public void run() {
		while(stop==true)
		{
			synchronized (this.com) {
				
				if(com.status==false){
					try {
						com.wait();
					} catch (InterruptedException e) {
						e.printStackTrace();
					}
				}	
					System.out.println("开始搬运！");
					try {
						Thread.sleep(200);
					} catch (InterruptedException e) {
						e.printStackTrace();
					}
					System.out.println("搬运完毕！");
					com.status=false;
                	/*判断现在的电脑数是否满足所需的电脑数*/
					if(compute.num==5) {
						System.out.println("所要库存已经制造完毕！");
						stop=false;	//如果满足，利用标志停止线程
					}else {
						System.out.println("继续制造下一台电脑！");
						System.out.println("--------------------");
					}
					this.com.notifyAll();	
			}
		}
	}
}
```

- 同步计算机类

```java
package impl;

public class compute {
	boolean status = false;
	static int num = 0;
}
```

